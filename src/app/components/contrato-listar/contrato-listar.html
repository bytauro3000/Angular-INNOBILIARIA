<div class="contratos-container">
  <h2 class="text-center">Lista de Contratos</h2>

  <div class="filtros-header">
    <div class="search-box">
      <span class="search-icon">üîç</span>
      <input
        type="text"
        [(ngModel)]="terminoBusqueda"
        (input)="filtrarContratos()"
        placeholder="Buscar por ID Contrato"
        class="form-control"
      />
    </div>

    <button [routerLink]="['/secretaria-menu/contratos/registrar']" class="btn btn-nuevo">
      + Nuevo Contrato
    </button>
  </div>

  <div class="tabla-wrapper">
    <table class="table-custom">
      <thead>
        <tr>
          <th style="width: 50px;">ID</th>
          <th>Nombre(s) del Cliente</th>
          <th>Documento de Identidad</th>
          <th>Fecha</th>
          <th>Tipo Contrato</th>
          <th>Monto Total</th>
          <th>Inicial</th>
          <th>Saldo</th>
          <th style="width: 80px;">N¬∞ Letras</th>
          <th style="width: 120px;">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let contrato of paginatedContratos; trackBy: trackById">
          <td class="text-center">{{ contrato.idContrato }}</td>
          <td>
            <div *ngFor="let cliente of contrato.clientes">
              {{ cliente.nombre }} {{ cliente.apellidos }}
            </div>
          </td>
          <td class="text-center">
            <div *ngFor="let cliente of contrato.clientes">
              {{ cliente.numDoc }}
            </div>
          </td>
          <td class="text-center">{{ contrato.fechaContrato | date: 'dd/MM/yyyy' }}</td>
          <td class="text-center">{{ contrato.tipoContrato }}</td>
          <td class="text-end">{{ contrato.montoTotal | currency: 'USD' }}</td>
          <td class="text-end">{{ contrato.inicial | currency: 'USD' }}</td>
          <td class="text-end">{{ contrato.saldo | currency: 'USD' }}</td>
          <td class="text-center">{{ contrato.cantidadLetras }}</td>
          <td class="acciones-cell">
            <div class="acciones-container">
              <button [routerLink]="['/secretaria-menu/contratos/editar', contrato.idContrato]"
                      class="btn-action btn-edit" title="Editar">
                <i class="bi bi-pencil"></i>
              </button>
              <button (click)="eliminarContrato(contrato.idContrato)" 
                      class="btn-action btn-delete" title="Eliminar">
                <i class="bi bi-trash"></i>
              </button>
              <a *ngIf="contrato.tipoContrato === 'FINANCIADO'"
                 [routerLink]="['/secretaria-menu/letras/insertar', contrato.idContrato]"
                 class="btn-action btn-info" title="Letras">
                <i class="bi bi-file-earmark-plus"></i>
              </a>
            </div>
          </td>
        </tr>
        <tr *ngIf="paginatedContratos.length === 0">
          <td colspan="10" class="no-data">No hay contratos para mostrar.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="totalPages > 1" class="paginacion-simple">
    <button (click)="previousPage()" [disabled]="currentPage === 1">Anterior</button>
    <span class="page-info">P√°gina {{currentPage}} de {{totalPages}}</span>
    <button (click)="nextPage()" [disabled]="currentPage === totalPages">Siguiente</button>
  </div>
</div>