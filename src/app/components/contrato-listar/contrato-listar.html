<div class="contratos-container">
  <h2 class="text-center">Lista de Contratos</h2>

  <div class="filtros-header">
    <div class="search-box">
      <span class="search-icon">üîç</span>
      <input
        type="text"
        [(ngModel)]="terminoBusqueda"
        (input)="filtrarContratos()"
        placeholder="Buscar por ID Contrato"
        class="form-control"
      />
    </div>

    <button [routerLink]="['/secretaria-menu/contratos/registrar']" class="btn btn-nuevo">
      + <span class="btn-text">Nuevo Contrato</span>
    </button>
  </div>

  <div class="tabla-wrapper">
    <table class="table-custom">
      <thead>
        <tr>
          <th style="width: 50px;">ID</th>
          <th>Nombre(s) del Cliente</th>
          <th>Documento</th>
          <th>Lote</th> <th>Fecha</th>
          <th>Tipo</th>
          <th>Total</th>
          <th>Inicial</th>
          <th>Saldo</th>
          <th style="width: 80px;">Letras</th>
          <th style="width: 150px;">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let contrato of paginatedContratos; trackBy: trackById">
          <td data-label="ID" class="text-center">{{ contrato.idContrato }}</td>
          <td data-label="Cliente">
  <div class="multi-item-container">
    <div *ngFor="let cliente of contrato.clientes">
      {{ cliente.nombre }} {{ cliente.apellidos }}
    </div>
  </div>
</td>

<td data-label="DNI" class="text-center">
  <div class="multi-item-container">
    <div *ngFor="let cliente of contrato.clientes">
      {{ cliente.numDoc }}
    </div>
  </div>
</td>

<td data-label="Lote" class="text-center">
  <div class="multi-item-container">
    <div *ngFor="let lote of contrato.lotes">
      Mz. {{ lote.manzana }} - Lt. {{ lote.numeroLote }}
    </div>
  </div>
</td>
          <td data-label="Fecha" class="text-center">{{ contrato.fechaContrato | date: 'dd/MM/yyyy' }}</td>
          <td data-label="Tipo" class="text-center">{{ contrato.tipoContrato }}</td>
          <td data-label="Total" class="text-end fw-bold">{{ contrato.montoTotal | currency: 'USD' }}</td>
          <td data-label="Inicial" class="text-end">{{ contrato.inicial | currency: 'USD' }}</td>
          <td data-label="Saldo" class="text-end">{{ contrato.saldo | currency: 'USD' }}</td>
          <td data-label="N¬∞ Letras" class="text-center">{{ contrato.cantidadLetras }}</td>
          <td data-label="Acciones" class="acciones-cell">
            <div class="acciones-container">
              <button (click)="imprimirContrato(contrato)" class="btn-action btn-print" title="Imprimir">
                <i class="bi bi-printer"></i>
              </button>
              <button [routerLink]="['/secretaria-menu/contratos/editar', contrato.idContrato]" class="btn-action btn-edit" title="Editar">
                <i class="bi bi-pencil"></i>
              </button>
              <button (click)="eliminarContrato(contrato.idContrato)" class="btn-action btn-delete" title="Eliminar">
                <i class="bi bi-trash"></i>
              </button>
              <a *ngIf="contrato.tipoContrato === 'FINANCIADO'" [routerLink]="['/secretaria-menu/letras/insertar', contrato.idContrato]" class="btn-action btn-info" title="Letras">
                <i class="bi bi-file-earmark-plus"></i>
              </a>
            </div>
          </td>
        </tr>
        <tr *ngIf="paginatedContratos.length === 0">
          <td colspan="11" class="no-data">No hay contratos para mostrar.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="totalPages > 1" class="paginacion-simple">
    <button (click)="previousPage()" [disabled]="currentPage === 1">Anterior</button>
    <span class="page-info">P√°gina {{currentPage}} de {{totalPages}}</span>
    <button (click)="nextPage()" [disabled]="currentPage === totalPages">Siguiente</button>
  </div>
</div>