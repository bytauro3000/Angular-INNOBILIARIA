<div class="clientes-container">
  <h2>Gestión de Clientes</h2>

  <div class="filtros">
    <select [(ngModel)]="tipoFiltro" (change)="filtrarClientes()" class="filtro-select">
      <option value="nombres">Nombres y Apellidos</option>
      <option value="documento">Documento (DNI/RUC)</option>
    </select>

    <input type="text" [(ngModel)]="terminoBusqueda" (input)="filtrarClientes()"
      placeholder="Ingresa el término de búsqueda..." class="filtro-input">

    <button (click)="abrirModal()" class="btn btn-success btn-agregar">
      <i class="bi bi-plus-lg"></i> <span>Agregar</span>
    </button>
  </div>

  <div class="tabla-clientes">
    <table>
      <thead>
        <tr>
          <th>Id</th>
          <th>Nombre</th>
          <th>Apellidos</th>
          <th>Tipo</th>
          <th>Documento</th>
          <th>Celular</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cliente of paginatedClientes">
          <td data-label="Id">{{ cliente.idCliente }}</td>
          <td data-label="Nombre">{{ cliente.nombre }}</td>
          <td data-label="Apellidos">{{ cliente.apellidos || '-' }}</td>
          <td data-label="Tipo">{{ cliente.tipoCliente }}</td>
          <td data-label="Documento">{{ cliente.numDoc || '-' }}</td>
          <td data-label="Celular">{{ cliente.celular }}</td>
          <td data-label="Estado">{{ cliente.estado }}</td>
          <td data-label="Acciones" class="acciones-cell">
            <button [routerLink]="['/secretaria-menu/clientes/ver', cliente.idCliente]"
              class="btn btn-outline-info btn-sm me-1" title="Ver cliente">
              <i class="bi bi-eye"></i>
            </button>
            
            <button (click)="editarModal.abrirModal(cliente.idCliente)"
              class="btn btn-outline-primary btn-sm me-1" title="Editar cliente">
              <i class="bi bi-pencil"></i>
            </button>

            <button class="btn btn-outline-danger btn-sm" (click)="eliminarCliente(cliente.idCliente)"
              title="Eliminar cliente">
              <i class="bi bi-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <div *ngIf="paginatedClientes.length === 0" class="no-results">
      No se encontraron clientes que coincidan con la búsqueda.
    </div>
  </div>

  <div *ngIf="totalPages > 1" class="paginacion-controles">
  <button (click)="previousPage()" [disabled]="currentPage === 1" class="pagina-btn">
    Anterior
  </button>

  <ng-container *ngFor="let page of getPagesArray()">
    <button *ngIf="page !== '...'" 
            (click)="goToPage($any(page))" 
            [class.active]="page === currentPage" 
            class="pagina-numero-btn">
      {{ page }}
    </button>

    <span *ngIf="page === '...'" class="ellipsis-spacer">...</span>
  </ng-container>

  <button (click)="nextPage()" [disabled]="currentPage === totalPages" class="pagina-btn">
    Siguiente
  </button>
</div>

  <app-cliente-insertar #registroModal (clienteGuardado)="cargarClientes()">
  </app-cliente-insertar>

  <app-cliente-editar #editarModal (clienteActualizado)="cargarClientes()">
  </app-cliente-editar>

</div>