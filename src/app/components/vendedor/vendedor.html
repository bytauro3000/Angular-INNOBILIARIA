<div class="container mt-4">
  <!-- T√≠tulo -->
  <h2 class="text-center mb-4 text-primary">üìã Listado de Vendedores</h2>

 <!-- Botones de acciones -->
<div class="d-flex justify-content-end gap-2 mb-3">
  <button class="btn btn-success" (click)="abrirModal()">
    ‚ûï Agregar Vendedor
  </button>
  <button class="btn btn-outline-primary" (click)="descargarExcel()">
    üì• Exportar Excel
  </button>
</div>



  <!-- Tabla -->
  <div class="table-responsive">
    <table class="table table-striped table-hover table-bordered align-middle shadow-sm rounded">
      <thead class="table-primary">
        <tr>
          <th style="width: 70px;">ID</th>
          <th>Nombre</th>
          <th>Apellidos</th>
          <th style="width:110px">DNI</th>
          <th style="width:130px">Celular</th>
          <th>Email</th>
          <th>Direcci√≥n</th>
          <th style="width:140px">Fecha Nac.</th>
          <th style="width:110px">G√©nero</th>
          <th style="width:110px">Comisi√≥n</th>
          <th>Distrito</th>
          <th style="width:160px">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let v of vendedores">
          <td>{{ v.idVendedor }}</td>
          <td>{{ v.nombre }}</td>
          <td>{{ v.apellidos }}</td>
          <td>{{ v.dni }}</td>
          <td>{{ v.celular || '‚Äî' }}</td>
          <td>{{ v.email || '‚Äî' }}</td>
          <td>{{ v.direccion || '‚Äî' }}</td>
          <td>
            {{ v.fechaNacimiento ? (v.fechaNacimiento | date: 'yyyy-MM-dd') : '‚Äî' }}
          </td>
          <td>{{ v.genero || '‚Äî' }}</td>
          <td>
            {{ v.comision != null ? (v.comision | number:'1.2-2') + '%' : '‚Äî' }}
          </td>
          <td>{{ v.distrito.nombre || '‚Äî' }}</td>
          <td>
            <button class="btn btn-sm btn-warning me-2" (click)="abrirModal(v)">‚úèÔ∏è Editar</button>
            <button class="btn btn-sm btn-danger" (click)="eliminarVendedor(v.idVendedor!)">üóëÔ∏è Eliminar</button>
          </td>
        </tr>

        <tr *ngIf="vendedores?.length === 0">
          <td colspan="12" class="text-center text-muted">No hay vendedores registrados.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="vendedorModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <form (ngSubmit)="guardarVendedor()" #vForm="ngForm">
        <div class="modal-header">
          <h5 class="modal-title">{{ vendedorEditando ? '‚úèÔ∏è Editar Vendedor' : '‚ûï Nuevo Vendedor' }}</h5>
          <button type="button" class="btn-close" (click)="cerrarModal()" aria-label="Cerrar"></button>
        </div>

        <div class="modal-body">
          <div class="row g-3">
            <!-- Nombre -->
            <div class="col-md-6">
              <label class="form-label">Nombre</label>
              <input type="text" class="form-control" [(ngModel)]="nuevoVendedor.nombre" name="nombre" required />
            </div>

            <!-- Apellidos -->
            <div class="col-md-6">
              <label class="form-label">Apellidos</label>
              <input type="text" class="form-control" [(ngModel)]="nuevoVendedor.apellidos" name="apellidos" required />
            </div>

            <!-- DNI -->
            <div class="col-md-4">
              <label class="form-label">DNI</label>
              <input type="text" class="form-control" [(ngModel)]="nuevoVendedor.dni" name="dni" required />
            </div>

            <!-- Celular -->
            <div class="col-md-4">
              <label class="form-label">Celular</label>
              <input type="text" class="form-control" [(ngModel)]="nuevoVendedor.celular" name="celular" />
            </div>

            <!-- Email -->
            <div class="col-md-4">
              <label class="form-label">Email</label>
              <input type="email" class="form-control" [(ngModel)]="nuevoVendedor.email" name="email" />
            </div>

            <!-- Direcci√≥n -->
            <div class="col-md-6">
              <label class="form-label">Direcci√≥n</label>
              <input type="text" class="form-control" [(ngModel)]="nuevoVendedor.direccion" name="direccion" />
            </div>

            <!-- Fecha de Nacimiento -->
            <div class="col-md-3">
              <label class="form-label">Fecha Nacimiento</label>
              <input type="date" class="form-control" [(ngModel)]="nuevoVendedor.fechaNacimiento" name="fechaNacimiento" />
            </div>

            <!-- G√©nero -->
            <div class="col-md-3">
              <label class="form-label">G√©nero</label>
              <select class="form-select" [(ngModel)]="nuevoVendedor.genero" name="genero">
                <option value="">-- Seleccione --</option>
                <option value="M">Masculino</option>
                <option value="F">Femenino</option>
                <option value="O">Otro</option>
              </select>
            </div>

            <!-- Comisi√≥n -->
            <div class="col-md-3">
              <label class="form-label">Comisi√≥n (%)</label>
              <input type="number" step="0.01" min="0" class="form-control" [(ngModel)]="nuevoVendedor.comision" name="comision" />
            </div>

            
            <!-- Distrito din√°mico -->
           <div class="col-md-3">
             <label class="form-label">Distrito</label>
               <select class="form-select" [(ngModel)]="nuevoVendedor.distrito" name="distrito" required>
                <option *ngFor="let d of distritos" [ngValue]="d">
                  {{ d.nombre }}
                </option>
               </select>
           </div>

          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="cerrarModal()">Cancelar</button>
          <button type="submit" class="btn btn-primary" [disabled]="vForm.invalid">
            {{ vendedorEditando ? 'Actualizar' : 'Guardar' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
